Тут указано короткая выжимка из статьи https://developer.mozilla.org/ru/docs/Web/Performance/How_browsers_work
# Навигация
## DNS запрос
Требуется понять на какой ip адрес требуется послать запрос. В кеше устройства некоторое время хранится информация о ip адреса по домену. Последовательность работы
1. Проверка кеша на наличие информации о адресе
2. Если не найдено идёт по dns серверам(провайдер....)
## TCP рукопожатие (handshake)
С известным ip адресом браузер начинает установку соединения с сервером. Происходит в 3 этапа SYN-SYN-ACK. Браузер и сервер обменивается 3-мя сообщениями

## TLS Переговоры (Negotation)
Требуется для работы https. 
1. Определяется какой шифр будет использоваться
2. Удостоверяется надёжность сервера
3. Устанавливается безопасное соединение
![[Pasted image 20250211181122.png]]

# Ответ на запрос
После установки соединения с сервером браузер отправляет инициирующий http get запрос на сервер. Чаще всего это html файл
> Время до первого байта TTFB(Time to first byte) - время до получения первого байта этого сообщения

> Интересная особенность TCP медленный старт / правило 14 kb - объём первого пакета 14kb, дальше объём увеличивается при каждом запросе на 14 kb, пока не будет определена максимальная ширина канала

Если пакет на дошёл, браузер не пошлёт подтверждение, сервер повторно вышлет сообщение

# Парсинг

Во время парсинга данные преобразуются в DOM и CSSOM

> DOM(Объектная модель документа) - внутреннее представление разметки html

> CSSOM(Объектная модель css) - внутреннее представление стилей css
## Построение DOM

Обработка html и построение DOM дерева.  

> Когда парсер находит неблокирующие ресурсы(например изображения), браузер отправляет запрос на загрузку, но сам продолжает обработку. Так-же может загрузить css файл. 
> 
> Но особое внимание script. По умолчанию script блокирующий. Требуется указывать async и defer для ручного контроля блокировки скрипта.
## Сканер предзагрузки
Построение DOM дерева занимает весь поток процесса. Для оптимизации был создан сканер предзагрузки. Он обрабатывает доступное содержимое документа и запрашивает высокоприоритетные ресурсы (CSS, JavaScript и шрифты)

> Благодаря этому сканеру нам не нужно ждать, пока парсер дойдёт до конкретного места, где вызывается ресурс
> 
> Он запрашивает и получает эти данные заранее, в фоновом режиме, так что когда основной поток HTML-парсера доходит до запроса ресурса, высока вероятность, что ресурс уже запрошен или находится в процессе загрузки
> 
> Чтобы сделать скрипт неблокирующим, добавьте атрибут `async` или, в случае, если порядок загрузки скриптов важен, атрибут `defer`

## Построение модели стилей CCSOM
CSSOM (объектная модель CSS) похожа на DOM. И DOM, и CSSOM - это деревья. Они являются независимыми структурами данных. Стили выстраиваются от наиболее общий, к более специфичным. Другими словами - правило каскада. 

> Построение CSSOM происходит очень быстро и не отображается отдельным цветом в средствах разработчика

## Остальные процессы

### Компиляция JavaScript
После формирования CSSOM и загрузки JS, браузер (каждый по разному) компилирует js в байткод. Байткод исполняется в основном потоке.

### Построение дерева доступности
Используется устройствами-помощниками для понимания и интерпретирования контента. 

> Объектная модель доступности (accessibility object model, AOM) - это семантическая версия DOM. Браузер обновляет AOM в тот же момент, когда обновляется DOM.

# Рендеринг

Созданные на предыдущем этапе комбинируются в дерево рендера, которое затем используется для расчёта положения каждого видимого элемента. После этого элементы будут отрисованы на экране

> В некоторых случаях содержимое может быть вынесено на отдельные слои и совмещено (composition) - такой подход увеличивает производительность, позволяя отрисовывать содержимое экрана на графическом процессоре вместо ЦПУ.

## Стилизация
Комбинирование DOM и CSSOM в дерево рендеринга
Конструирование этого дерева начинается с прохода всего DOM-дерева от корня, с выявлением каждого видимого узла.

## Компоновка (Layout)
Запуск компоновки элементов дерева рендера. Вычисляется геометрия каждого узла. То есть ширина, высота, положение элементов.

## Отрисовка(Paint)
Отрисовка каждого отдельного узла на экране

> Время до окончания первой отрисовки - first meaningful paint

Во время фазы отрисовки или растеризации, браузер конвертирует каждый контейнер box в настоящие пиксели на экране (напомним, что данные контейнеров формируются на этапе layout)

# Интеграктивность

После загрузки скриптов и выполнения предыдущий шагов начинается выполнение js. Это называется интерактивность.


> Время до появления интерактивности - time to interactive









