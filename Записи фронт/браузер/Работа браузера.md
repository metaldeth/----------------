# **Навигация**

## **DNS-запрос**  
Для отправки запроса требуется определить IP-адрес по домену. Информация о IP-адресах некоторое время хранится в кеше устройства.  

**Последовательность работы:**  
1. Проверка кеша на наличие информации об адресе.  
2. Если информация не найдена, запрос идёт по DNS-серверам (провайдер, корневые серверы и т.д.).  

---

## **TCP-рукопожатие (Handshake)**  
С известным IP-адресом браузер устанавливает соединение с сервером. Процесс происходит в три этапа: **SYN-SYN-ACK**. Браузер и сервер обмениваются тремя сообщениями.  

---

## **TLS-переговоры (Negotiation)**  
Необходимы для работы HTTPS.  

**Этапы:**  
1. Определение используемого шифра.  
2. Проверка надёжности сервера.  
3. Установка безопасного соединения.  

![[Pasted image 20250211181122.png]]

---

# **Ответ на запрос**  
После установки соединения браузер отправляет HTTP GET-запрос на сервер. Чаще всего запрашивается HTML-файл.  

> **TTFB (Time to First Byte)** — время до получения первого байта ответа.  

> **Интересная особенность TCP:**  
> - **Медленный старт / правило 14 KB** — объём первого пакета составляет 14 KB. При каждом последующем запросе объём увеличивается на 14 KB, пока не будет определена максимальная пропускная способность канала.  

Если пакет не доходит, браузер не отправляет подтверждение, и сервер повторно отправляет сообщение.  

---

# **Парсинг**  
Во время парсинга данные преобразуются в **DOM** и **CSSOM**.  

> **DOM (Document Object Model)** — внутреннее представление HTML-разметки.  
> **CSSOM (CSS Object Model)** — внутреннее представление CSS-стилей.  

---

## **Построение DOM**  
Обработка HTML и построение DOM-дерева.  

> **Особенности:**  
> - Если парсер находит неблокирующие ресурсы (например, изображения), браузер отправляет запрос на их загрузку, но продолжает обработку.  
> - Скрипты (`<script>`) по умолчанию блокирующие. Для контроля их выполнения используются атрибуты `async` и `defer`.  

---

## **Сканер предзагрузки**  
Построение DOM занимает весь поток процесса. Для оптимизации используется **сканер предзагрузки**, который запрашивает высокоприоритетные ресурсы (CSS, JavaScript, шрифты) заранее.  

> **Преимущества:**  
> - Ресурсы загружаются в фоновом режиме, что ускоряет их доступность.  
> - Чтобы сделать скрипт неблокирующим, используйте атрибуты `async` или `defer`.  

---

## **Построение CSSOM**  
CSSOM похож на DOM, но представляет собой независимую структуру данных. Стили выстраиваются от общих к более специфичным (правило каскада).  

> **Особенность:**  
> - Построение CSSOM происходит быстро и не отображается отдельно в инструментах разработчика.  

---

# **Остальные процессы**  

### **Компиляция JavaScript**  
После формирования CSSOM и загрузки JavaScript браузер компилирует JS в байткод, который исполняется в основном потоке.  

### **Построение дерева доступности**  
Используется устройствами-помощниками для интерпретации контента.  

> **AOM (Accessibility Object Model)** — семантическая версия DOM. Обновляется одновременно с DOM.  

---

# **Рендеринг**  
Созданные на предыдущих этапах данные комбинируются в **дерево рендера**, которое используется для расчёта положения каждого видимого элемента. Затем элементы отрисовываются на экране.  

> **Особенность:**  
> - Некоторые элементы могут быть вынесены на отдельные слои и совмещены (composition), что повышает производительность за счёт использования GPU вместо CPU.  

---

## **Стилизация**  
Комбинирование DOM и CSSOM в **дерево рендеринга**. Процесс начинается с прохода по всему DOM-дереву и выявления видимых узлов.  

---

## **Компоновка (Layout)**  
Вычисление геометрии каждого узла дерева рендера: ширина, высота, положение элементов.  

---

## **Отрисовка (Paint)**  
Отрисовка каждого узла на экране.  

> **FMP (First Meaningful Paint)** — время до окончания первой отрисовки.  

---

# **Интерактивность**  
После загрузки скриптов и выполнения предыдущих шагов начинается выполнение JavaScript. Это называется **интерактивностью**.  

> **TTI (Time to Interactive)** — время до появления интерактивности.  